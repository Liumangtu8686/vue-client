import{D as t}from"../database-ql/database-ql.dae16e5e.js";import{a as e}from"../axios/axios.74947802.js";var n,r;(r=n||(n={})).H5="h5",r.WX_MP="wxmp",r.UNI_APP="uniapp";var o,i=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},a=globalThis&&globalThis.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=function(){function t(t){this.options=Object.assign({},t),this.options.timeout=(null==t?void 0:t.timeout)||15e3}return t.prototype.send=function(t,e){return i(this,void 0,void 0,(function(){var n,r,o;return a(this,(function(i){switch(i.label){case 0:n=Object.assign({},e,{action:t}),r=setTimeout((function(){}),3e3),i.label=1;case 1:return i.trys.push([1,,3,4]),o=this.options.baseUrl+this.options.dbProxyUrl,[4,this.request(o,n)];case 2:return[2,i.sent().data];case 3:return clearTimeout(r),[7];case 4:return[2]}}))}))},t.prototype.request=function(t,r){return i(this,void 0,void 0,(function(){var o,i;return a(this,(function(a){switch(a.label){case 0:if(this.options.environment!==n.H5)throw new Error("environment type must be h5");return o=this.options.getAccessToken(),i=this.getHeaders(o),[4,e.post(t,r,{headers:i,timeout:this.options.timeout})];case 1:return[2,a.sent()]}}))}))},t.prototype.getHeaders=function(t,e){var n;e=null!=e?e:{"Content-Type":"application/json"},t&&(e.Authorization="Bearer "+t);var r=(null===(n=this.options)||void 0===n?void 0:n.headers)||{};return Object.assign(e,r)},t}(),s=globalThis&&globalThis.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},c=globalThis&&globalThis.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},f=function(t){function e(e){return t.call(this,e)||this}return s(e,t),e.prototype.request=function(t,e,r){var o;return l(this,void 0,void 0,(function(){var i,a,u;return c(this,(function(s){switch(s.label){case 0:if(this.options.environment!==n.UNI_APP)throw new Error("environment type must be uniapp");return i=this.options.getAccessToken(),a=this.getHeaders(i),u={url:t,header:a,method:null!==(o=null==r?void 0:r.method)&&void 0!==o?o:"POST",data:e,dataType:"json"},[4,uni.request(u)];case 1:return[2,s.sent()]}}))}))},e}(u),h=globalThis&&globalThis.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=globalThis&&globalThis.__assign||function(){return p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},p.apply(this,arguments)},b=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},y=globalThis&&globalThis.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},v=function(t){function e(e){return t.call(this,e)||this}return h(e,t),e.prototype.request=function(t,e,r){var o;return b(this,void 0,void 0,(function(){var i,a,u;return y(this,(function(s){if(this.options.environment!==n.WX_MP)throw new Error("environment type must be wxmp");return i=this.options.getAccessToken(),a=this.getHeaders(i),u={url:t,header:a,method:null!==(o=null==r?void 0:r.method)&&void 0!==o?o:"POST",data:e,dataType:"json"},[2,new Promise((function(t,e){wx.request(p(p({},u),{success:function(e){t(e)},fail:function(t){e(t)}}))}))]}))}))},e}(u),d=globalThis&&globalThis.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},w=globalThis&&globalThis.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},g=function(){function e(t){this.config={baseUrl:t.baseUrl,dbProxyUrl:t.dbProxyUrl,getAccessToken:(null==t?void 0:t.getAccessToken)||function(){return""},environment:(null==t?void 0:t.environment)||n.H5,primaryKey:null==t?void 0:t.primaryKey,timeout:null==t?void 0:t.timeout,headers:null==t?void 0:t.headers,requestClass:null==t?void 0:t.requestClass};var e=this.requestClass;this._request=new e(this.config)}return Object.defineProperty(e.prototype,"requestClass",{get:function(){var t,e,r,o=null===(t=this.config)||void 0===t?void 0:t.environment;return(null===(e=this.config)||void 0===e?void 0:e.requestClass)?null===(r=this.config)||void 0===r?void 0:r.requestClass:o===n.UNI_APP?f:o===n.WX_MP?v:u},enumerable:!0,configurable:!0}),e.prototype.database=function(){var e;return new t({request:this._request,primaryKey:null===(e=this.config)||void 0===e?void 0:e.primaryKey})},e.prototype.invokeFunction=function(t,e){return d(this,void 0,void 0,(function(){var n;return w(this,(function(r){switch(r.label){case 0:return n=this.config.baseUrl+"/"+t,[4,this._request.request(n,e)];case 1:return[2,r.sent().data]}}))}))},e.prototype.invoke=function(t,e){return d(this,void 0,void 0,(function(){return w(this,(function(n){switch(n.label){case 0:return[4,this.invokeFunction(t,e)];case 1:return[2,n.sent()]}}))}))},e}();globalThis.wx&&!globalThis.process&&(globalThis.process={env:{}});export{g as C};
